---
layout: default
title: SEO Анализатор страниц
description: Анализ SEO-параметров с новыми метриками
---

<style>
  /* Существующие стили остаются без изменений */
  /* Добавляем только новые стили для метрик */
  .seo-metrics {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1.5rem;
    margin: 2rem 0;
  }

  .metric-card {
    background: white;
    border-radius: var(--border-radius);
    padding: 1.5rem;
    box-shadow: var(--box-shadow);
    border-left: 3px solid var(--primary-color);
  }

  .metric-title {
    font-size: 1.4rem;
    color: var(--gray-dark);
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .metric-value {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--dark-color);
  }

  .metric-good { color: var(--success-color); }
  .metric-warning { color: var(--warning-color); }
  .metric-bad { color: var(--danger-color); }

  .metric-icon {
    width: 20px;
    height: 20px;
    stroke-width: 2;
  }

  @media (max-width: 768px) {
    .seo-metrics {
      grid-template-columns: 1fr;
    }
  }
</style>

<section class="hero" id="hero">
  <div class="container">
    <h1>SEO Анализатор</h1>
    <p>Введите URL страниц для анализа (каждый URL с новой строки)</p>
    
    <form id="urlForm" class="seo-analysis">
      <div class="form__group">
        <textarea name="urls" id="urls" class="form__input" rows="5" required 
                  placeholder="https://example.com&#10;https://example.org"></textarea>
        <label for="urls" class="form__label">URL страниц</label>
      </div>
      
      <div class="form__group">
        <input type="text" name="keyword" id="keyword" class="form__input" 
               placeholder="Ключевая фраза">
        <label for="keyword" class="form__label">Ключевая фраза (необязательно)</label>
      </div>
      
      <button type="submit" class="button button--primary">Анализировать</button>
      
      <div id="formMessage" style="display: none;"></div>
    </form>
    
    <div id="results" class="seo-analysis" style="display: none;">
      <h2>Результаты анализа</h2>
      <div id="resultsContent"></div>
    </div>
  </div>

  <div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
    <p>Идет анализ страниц, пожалуйста подождите...</p>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.getElementById('urlForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const urlsInput = e.target.urls.value;
    const keyword = e.target.keyword.value;
    const urls = urlsInput.split('\n').map(url => url.trim()).filter(url => url !== '');
    
    if (urls.length === 0) {
      showMessage('Введите хотя бы один URL', 'error');
      return;
    }

    const loadingOverlay = document.getElementById('loadingOverlay');
    loadingOverlay.style.display = 'flex';
    
    try {
      const response = await fetch('https://seoparse.netlify.app/.netlify/functions/hello', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ urls, keyword })
      });
      
      if (!response.ok) throw new Error('Ошибка сервера: ' + response.status);
      
      const data = await response.json();
      displayResults(data, keyword);
    } catch (error) {
      showMessage('Ошибка: ' + error.message, 'error');
      console.error('Ошибка:', error);
    } finally {
      loadingOverlay.style.display = 'none';
    }
  });

  function showMessage(text, type) {
    const messageEl = document.getElementById('formMessage');
    messageEl.textContent = text;
    messageEl.className = type === 'error' ? 'error-message' : 'success-message';
    messageEl.style.display = 'block';
    setTimeout(() => messageEl.style.display = 'none', 5000);
  }

  function displayResults(data, keyword) {
    const resultsContainer = document.getElementById('results');
    const resultsContent = document.getElementById('resultsContent');
    
    resultsContainer.style.display = 'block';
    resultsContent.innerHTML = '';
    
    if (!Array.isArray(data)) {
      resultsContent.innerHTML = '<div class="error-message">Ошибка данных</div>';
      return;
    }
    
    data.forEach((item, index) => {
      const isError = item.error || item.status >= 400;
      const card = document.createElement('div');
      card.className = `result-card ${isError ? 'error' : ''}`;
      
      card.innerHTML = `
        <div class="result-header">
          <div class="result-url">${item.url}</div>
          <div class="result-status ${isError ? 'error' : ''}">
            ${isError ? 'Ошибка' : 'Статус: ' + item.status}
          </div>
        </div>
      `;
      
      if (!isError) {
        // Новые метрики
        card.innerHTML += `
          <div class="seo-metrics">
            <div class="metric-card">
              <div class="metric-title">
                <svg class="metric-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                </svg>
                Анализ URL
              </div>
              <div class="metric-value ${item.urlAnalysis.length > 60 ? 'metric-bad' : 'metric-good'}">
                ${item.urlAnalysis.length} симв.
              </div>
              <div style="margin-top: 0.5rem; font-size: 1.3rem; color: var(--gray-dark);">
                ${item.urlAnalysis.isDynamic ? '❌ Динамический' : '✅ ЧПУ'}
                ${item.urlAnalysis.hasKeyword ? '· ✅ Ключ. слово' : ''}
              </div>
            </div>

            <div class="metric-card">
              <div class="metric-title">
                <svg class="metric-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                Скорость
              </div>
              <div class="metric-value ${item.loadTime > 2000 ? 'metric-bad' : item.loadTime > 1000 ? 'metric-warning' : 'metric-good'}">
                ${item.loadTime} мс
              </div>
            </div>

            <div class="metric-card">
              <div class="metric-title">
                <svg class="metric-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                Контент
              </div>
              <div class="metric-value ${item.contentAnalysis.length < 1500 ? 'metric-bad' : item.contentAnalysis.length < 2500 ? 'metric-warning' : 'metric-good'}">
                ${item.contentAnalysis.length} симв.
              </div>
              <div style="margin-top: 0.5rem; font-size: 1.3rem; color: var(--gray-dark);">
                ${Math.round(item.contentAnalysis.textToCodeRatio)}% текста
              </div>
            </div>
          </div>

          <!-- Существующие данные -->
          <div class="result-meta">
            <div class="meta-item">
              <span class="meta-label">Title</span>
              <span class="meta-value">${item.title || '—'}</span>
            </div>
            <div class="meta-item">
              <span class="meta-label">H1</span>
              <span class="meta-value">${item.h1 || '—'}</span>
            </div>
            <div class="meta-item">
              <span class="meta-label">Description</span>
              <span class="meta-value">${item.description || '—'}</span>
            </div>
            ${keyword ? `
              <div class="meta-item">
                <span class="meta-label">Ключевая фраза</span>
                <span class="meta-value">
                  ${item.keywordStats.exactCount} точных вхождений
                </span>
              </div>
            ` : ''}
          </div>

          <div class="details-toggle" data-index="${index}">▼ Показать детали</div>
          <div class="details-content" id="details-${index}" style="display: none;">
            <div class="meta-item">
              <span class="meta-label">H2 заголовки (${item.h2.length})</span>
              ${item.h2.length > 0 ? `
                <ul style="margin-top: 0.5rem;">
                  ${item.h2.map(h2 => `<li>${h2}</li>`).join('')}
                </ul>
              ` : '<span>Отсутствуют</span>'}
            </div>
            <div class="meta-item">
              <span class="meta-label">Alt тексты (${item.alts.filter(a => a).length})</span>
              ${item.alts.filter(a => a).length > 0 ? `
                <div style="margin-top: 0.5rem;">
                  ${item.alts.filter(a => a).map(alt => `<span class="tag">${alt}</span>`).join('')}
                </div>
              ` : '<span>Отсутствуют</span>'}
            </div>
          </div>
        `;
      } else {
        card.innerHTML += `<div class="error-message">${item.error}</div>`;
      }
      
      resultsContent.appendChild(card);
    });

    // Обработчики для раскрытия деталей
    document.querySelectorAll('.details-toggle').forEach(toggle => {
      toggle.addEventListener('click', function(e) {
        e.preventDefault();
        const details = document.getElementById(this.getAttribute('data-index'));
        details.style.display = details.style.display === 'none' ? 'block' : 'none';
        this.textContent = details.style.display === 'none' ? '▼ Показать детали' : '▲ Скрыть детали';
      });
    });
  }
</script>